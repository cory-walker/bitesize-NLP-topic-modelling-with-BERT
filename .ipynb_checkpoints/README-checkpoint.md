# NLP Topic modelling with BERT
Today we will be clustering cleaned 20newsgroups comments by:
<ol>
    <li>Converting each comment into a 768 dimensional vector array using BERT</li>
    <li>Reducing each array's dimensionality via UMAP (Uniform Manifold Approximation and Projection)</li>
    <li>Clustering the UMAP arrays with hdbscan</li>
    <li>Converting each cluster into one large document, and then extracting the key words using TF-IDF (term frequencyâ€“inverse document frequency)</li>
    <li>Optional: Plotting a 2-dimensional version of the clusters using matplotlib</li>
</ol>

## libraries
<ul>
    <li><a href=https://pandas.pydata.org/>pandas</a></li>
    <li><a href=https://docs.python.org/3/library/logging.html>logging</a></li>
    <li><a href=https://docs.python.org/3/library/datetime.html>datetime</a></li>
    <li><a href=https://umap-learn.readthedocs.io/en/latest/>umap</a></li>
    <li><a href=https://numpy.org/>numpy</a></li>
    <li><a href=https://hdbscan.readthedocs.io/en/latest/>hdbscan</a></li>
    <li><a href=https://pypi.org/project/sentence-transformers/>sentence_transformers</a></li>
    <li><a href=https://scikit-learn.org/stable/>sklearn</a></li>
    <li><a href=https://matplotlib.org/>matplotlib</a></li>
</ul>

## Instructions
Follow the Jupyter notebook from top to bottom. BERT embedding takes the longest by far, and time will depend heavily on your GPU.<br>
Reducing the embeddings further to 2 dimensions and plotting them is optional, but can be a great visual aid.

## Files
<ul> 
    <li>bitsize-NLP-topic-modelling-with-BERT.ipynb: Jupyter notebook file where all the code lives</li>
<li>20newsgroups_top_words.csv: This is generated by the notebook and will be used in a <a href=https://github.com/cory-walker/bitesize-visualizing-topics-using-network-graphs>network diagram project</a></li>
<li>topic-modelling-with-BERT.log: This log file is generated by the notebook</li>
</ul>
    
## Acknowledgements
<a href=https://towardsdatascience.com/topic-modeling-with-bert-779f7db187e6>This FANTASTIC tutorial</a> where I first learned these methods for topic modelling
